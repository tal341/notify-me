<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>â° ×ª×–×›×•×¨×•×ª ×¤×©×•×˜×•×ª</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://img.icons8.com/ios-filled/50/000000/alarm.png">

    <style>
        :root {
            --bg: #1e1e2f;
            --card: #2a2a3d;
            --accent: #00ff88;
            --text: #e0e0ff;
            --radius: 12px;
            --shadow: 0 4px 12px rgba(0,0,0,.4);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: system-ui, Arial, Helvetica, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 2rem 1rem;
        }
        .container {
            width: 100%;
            max-width: 560px;
        }
        h1 {
            font-size: 2.2rem;
            text-align: center;
            margin-bottom: 1rem;
            color: var(--accent);
        }
        .card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }
        input, select, textarea, button {
            width: 100%;
            font-size: 1rem;
            padding: .8rem 1rem;
            margin-top: .5rem;
            border: none;
            border-radius: var(--radius);
        }
        input, select, textarea {
            background: #3a3a5a;
            color: #fff;
        }
        button {
            background: var(--accent);
            color: #000;
            font-weight: bold;
            cursor: pointer;
            transition: transform .1s;
        }
        button:hover { transform: scale(1.02); }
        button:active { transform: scale(.98); }
        .small { font-size: .9rem; }
        .mt { margin-top: 1rem; }
        .center { text-align: center; }
        #messagePreview {
            margin-top: .8rem;
            padding: .6rem;
            background: #3a3a5a;
            border-radius: var(--radius);
            font-style: italic;
        }
        @media (max-width: 480px) {
            h1 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>â° ×ª×–×›×•×¨×•×ª ×¤×©×•×˜×•×ª</h1>

        <div class="card">
            <h2 class="small">ğŸ—’ï¸ ×©× & ×–××Ÿ</h2>
            <input id="title" type="text" placeholder="×©× ×”×ª×–×›×•×¨×ª (×œ×“×•×’××”: ×œ×§×—×ª ×ª×¨×•×¤×”)" required>
            <input id="time" type="time" required>

            <h2 class="small mt">ğŸ’¬ ×”×•×“×¢×” ××•×ª×××ª</h2>
            <textarea id="msg" rows="2" placeholder="×”×•×“×¢×” ×©×ª×•×¤×™×¢ (×× ×¨×™×§ â€“ × ×•×¦×¨×” ×”×•×“×¢×” ××•×˜×•××˜×™×ª)"></textarea>
            <select id="msgStyle" class="small">
                <option value="normal">×¨×’×™×œ×”</option>
                <option value="funny">×”×•××•×¨×™×¡×˜×™×ª</option>
                <option value="motiv">××¢×•×“×“×ª</option>
            </select>
            <div id="messagePreview"></div>

            <h2 class="small mt">ğŸ”Š ×•×•×œ×™×•×</h2>
            <input type="range" id="volume" min="0" max="100" value="70" class="small">
            <div class="small">×¢×•×¦××”: <span id="volDisplay">70%</span></div>

            <button id="addBtn" class="mt">âœ¨ ×”×•×¡×£ ×ª×–×›×•×¨×ª</button>
        </div>

        <div class="card">
            <h2 class="small">ğŸ“‹ ×ª×–×›×•×¨×•×ª ×¤×¢×™×œ×•×ª</h2>
            <div id="list"></div>
        </div>
    </div>

    <!-- ×¦×œ×™×œ ×‘×¨×™×¨×ª ××—×“×œ (MP3 ×§×¦×¨) -->
    <audio id="defaultSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <script>
        const STORAGE_KEY = 'simpleReminders';
        let reminders = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

        function generateMessage(title, style) {
            const base = `×”×™×™! ×”×’×™×¢ ×”×–××Ÿ ×œ-${title}.`;
            if (style === 'funny') return `${base} ğŸ˜† ××œ ×ª×ª×Ÿ ×œ×©×¢×•×Ÿ ×œ×©×§×¨ ××•×ª×š!`;
            if (style === 'motiv') return `${base} ğŸ’ª ×ª×–×›×•×¨ â€“ ×›×œ ×¦×¢×“ ×§×˜×Ÿ ××•×‘×™×œ ×œ×”×¦×œ×—×”!`;
            return base;
        }

        document.getElementById('msg').addEventListener('input', updateMsgPreview);
        document.getElementById('msgStyle').addEventListener('change', updateMsgPreview);
        document.getElementById('volume').addEventListener('input', () => {
            document.getElementById('volDisplay').textContent = document.getElementById('volume').value + '%';
        });

        function updateMsgPreview() {
            const txt = document.getElementById('msg').value.trim();
            const style = document.getElementById('msgStyle').value;
            const title = document.getElementById('title').value.trim() || '×”×ª×–×›×•×¨×ª';
            const out = txt || generateMessage(title, style);
            document.getElementById('messagePreview').textContent = out;
        }

        document.getElementById('addBtn').addEventListener('click', () => {
            const title = document.getElementById('title').value.trim();
            const timeStr = document.getElementById('time').value;
            const msgRaw = document.getElementById('msg').value.trim();
            const style = document.getElementById('msgStyle').value;
            const volume = document.getElementById('volume').value;

            if (!title || !timeStr) {
                alert('×”×›× ×¡ ×©× ×•×–××Ÿ.');
                return;
            }

            const now = new Date();
            const [h, m] = timeStr.split(':').map(Number);
            const target = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0, 0);
            if (target <= now) target.setDate(target.getDate() + 1);
            const delay = target.getTime() - now.getTime();

            const reminder = {
                id: Date.now(),
                title,
                time: timeStr,
                target: target.getTime(),
                msg: msgRaw || generateMessage(title, style),
                volume,
                active: true
            };

            reminders.push(reminder);
            saveReminders();
            renderList();
            schedule(reminder, delay);
            clearForm();
        });

        function saveReminders() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(reminders));
        }

        function renderList() {
            const list = document.getElementById('list');
            if (reminders.length === 0) {
                list.innerHTML = '<p class="small">××™×Ÿ ×ª×–×›×•×¨×•×ª ×¤×¢×™×œ×•×ª.</p>';
                return;
            }
            list.innerHTML = reminders.map(r => `
                <div class="small" style="margin:.6rem 0; padding:.6rem; background:#3a3a5a; border-radius:var(--radius);">
                    <b>${r.title}</b> â€“ ${new Date(r.target).toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' })}
                    <br>×”×•×“×¢×”: ${r.msg}
                    <br><button class="small" onclick="deleteReminder(${r.id})">ğŸ—‘ï¸ ××—×§</button>
                </div>
            `).join('');
        }

        function deleteReminder(id) {
            reminders = reminders.filter(r => r.id !== id);
            saveReminders();
            renderList();
        }

        function clearForm() {
            document.getElementById('title').value = '';
            document.getElementById('time').value = '';
            document.getElementById('msg').value = '';
            document.getElementById('msgStyle').value = 'normal';
            document.getElementById('messagePreview').textContent = '';
            document.getElementById('volume').value = 70;
            document.getElementById('volDisplay').textContent = '70%';
        }

        function schedule(rem, delay) {
            setTimeout(() => showNotification(rem), delay);
        }

        async function showNotification(rem) {
            // 1ï¸âƒ£ ×‘×§×©×ª ×”×¨×©××” (××ª×‘×¦×¢×ª ×¨×§ ×‘×¤×¢× ×”×¨××©×•× ×”)
            if (Notification.permission !== 'granted') {
                await Notification.requestPermission();
            }

            // 2ï¸âƒ£ ×™×¦×™×¨×ª ×”×”×ª×¨××”
            const notif = new Notification(rem.title, {
                body: rem.msg,
                icon: 'https://img.icons8.com/ios-filled/50/000000/alarm.png'
            });

            // 3ï¸âƒ£ × ×’×Ÿ ×¦×œ×™×œ ×‘×¨×™×¨×ª ××—×“×œ
            const audio = document.getElementById('defaultSound').cloneNode();
            audio.volume = rem.volume / 100;
            audio.play().catch(() => {}); // ×‘××™×“×” ×©×”×“×¤×“×¤×Ÿ ×—×•×¡× autoplay

            // 4ï¸âƒ£ ×›×¤×ª×•×¨ "×”×‘× ×ª×™" â€“ ×¡×•×’×¨ ××ª ×”×”×ª×¨××”
            notif.onclick = () => { notif.close(); audio.pause(); };
        }

        function init() {
            // ×× ×™×© ×ª×–×›×•×¨×•×ª ×©××™×•×¢×“×•×ª ×œ×¢×ª×™×“ â€“ × ×–××Ÿ ××•×ª×Ÿ ××—×“×©
            const now = Date.now();
            reminders.forEach(r => {
                if (r.active && r.target > now) {
                    schedule(r, r.target - now);
                }
            });
            renderList();
        }

        init();
    </script>
</body>
</html>
